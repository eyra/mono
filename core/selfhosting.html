<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="ExDoc v0.36.1">
    <meta name="project" content="core v0.1.0">


    <title>Self hosting — core v0.1.0</title>
    <link rel="stylesheet" href="dist/html-elixir-QYVRUQZX.css" />

    <script src="dist/handlebars.runtime-NWIB6V2M.js"></script>
    <script src="dist/handlebars.templates-K7URE6B4.js"></script>
    <script src="dist/sidebar_items-FA7A3854.js"></script>
    <script src="docs_config.js"></script>
    <script async src="dist/html-HJ5ACJPS.js"></script>

  </head>
  <body class="sidebar-closed">
    <script>

      try {
        var settings = JSON.parse(localStorage.getItem('ex_doc:settings') || '{}');

        if (settings.theme === 'dark' ||
           ((settings.theme === 'system' || settings.theme == null) &&
             window.matchMedia('(prefers-color-scheme: dark)').matches)
           ) {
          document.body.classList.add('dark')
        }
      } catch (error) { }
    </script>

<div class="body-wrapper">

<button id="sidebar-menu" class="sidebar-button sidebar-toggle" aria-label="toggle sidebar" aria-controls="sidebar">
  <i class="ri-menu-line ri-lg" title="Collapse/expand sidebar"></i>
</button>

<nav id="sidebar" class="sidebar">

  <div class="sidebar-header">
    <div class="sidebar-projectInfo">

        <a href="readme.html" class="sidebar-projectImage">
          <img src="assets/logo.svg" alt="core" />
        </a>

      <div>
        <a href="readme.html" class="sidebar-projectName" translate="no">
core
        </a>
        <div class="sidebar-projectVersion" translate="no">
          v0.1.0
        </div>
      </div>
    </div>
    <ul id="sidebar-list-nav" class="sidebar-list-nav" role="tablist">
      <li>
        <button id="extras-list-tab-button" role="tab" data-type="extras" aria-controls="extras-tab-panel" aria-selected="true" tabindex="0">
Pages
        </button>
      </li>

        <li>
          <button id="modules-list-tab-button" role="tab" data-type="modules" aria-controls="modules-tab-panel" aria-selected="false" tabindex="-1">
            Modules
          </button>
        </li>


        <li>
          <button id="tasks-list-tab-button" role="tab" data-type="tasks" aria-controls="tasks-tab-panel" aria-selected="false" tabindex="-1">
            <span translate="no">Mix</span> Tasks
          </button>
        </li>

    </ul>
  </div>

  <div id="extras-tab-panel" class="sidebar-tabpanel" role="tabpanel" aria-labelledby="extras-list-tab-button">
    <ul id="extras-full-list" class="full-list"></ul>
  </div>

    <div id="modules-tab-panel" class="sidebar-tabpanel" role="tabpanel" aria-labelledby="modules-list-tab-button" hidden>
      <ul id="modules-full-list" class="full-list"></ul>
    </div>


    <div id="tasks-tab-panel" class="sidebar-tabpanel" role="tabpanel" aria-labelledby="tasks-list-tab-button" hidden>
      <ul id="tasks-full-list" class="full-list"></ul>
    </div>

</nav>

<output role="status" id="toast"></output>

<main class="content page-extra" id="main" data-type="extras">
  <div id="content" class="content-inner">
    <div class="top-search">
      <div class="search-settings">
        <form class="search-bar" action="search.html">
          <label class="search-label">
            <span class="sr-only">Search documentation of core</span>
            <input name="q" type="text" class="search-input" placeholder="Press / to search" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" />
          </label>
          <button type="submit" class="search-button" aria-label="Submit Search" tabindex="-1">
            <i class="ri-search-2-line ri-lg" aria-hidden="true"></i>
          </button>
          <button type="button" tabindex="-1" class="search-close-button" aria-hidden="true">
            <i class="ri-close-line ri-lg" title="Cancel search"></i>
          </button>
        </form>
        <div class="autocomplete">
        </div>
        <button class="icon-settings display-settings">
          <i class="ri-settings-3-line"></i>
          <span class="sr-only">Settings</span>
        </button>
      </div>
    </div>

<div id="top-content">
  <h1>

      <a href="https://github.com/eyra/mono/blob/main/../SELFHOSTING.md#L1" title="View Source" class="icon-action" rel="help">
        <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        <span class="sr-only">View Source</span>
      </a>


    <span>Self hosting</span>
  </h1>

<h2 id="development-instructions" class="section-heading">
  <a href="#development-instructions" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Development instructions</span>
</h2>
<h3 id="setup" class="section-heading">
  <a href="#setup" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Setup</span>
</h3>
<ol start="0"><li><p>Pre-requisite</p><ul><li>Install <a href="https://asdf-vm.com">asdf</a></li><li>Install <a href="https://www.postgresql.org">PostgreSQL Server</a></li><li>Fork and clone branch <code class="inline">master</code> of this Mono repo.</li><li>Register application on <a href="https://unsplash.com/">Unsplash</a> which is used as an Image Catalog.</li></ul></li><li><p>Create a PostgreSQL database and replace the configurated values in <code class="inline">core/config/dev.exs</code> with your own:</p><pre><code class="Elixir"> # Configure your database
 config :core, Core.Repo,
 username: &quot;postgres&quot;,
 password: &quot;postgres&quot;,
 database: &quot;self_dev&quot;,</code></pre></li><li><p>Install tools:</p><pre><code class="makeup sh" translate="no"><span class=""> $ asdf plugin-add erlang
</span><span class=""> $ asdf plugin-add elixir
</span><span class=""> $ asdf plugin-add nodejs
</span><span class="">
</span><span class=""> $ asdf install
</span></code></pre><p> See <code class="inline">.tool-versions</code> for the exact versions that will be installed</p></li><li><p>Setup:</p><pre><code class="makeup sh" translate="no"><span class=""> $ cd core
</span><span class=""> $ mix setup
</span></code></pre></li><li><p>Build Core (from core folder):</p><pre><code class="makeup sh" translate="no"><span class=""> $ BUNDLE=self mix compile
</span></code></pre></li><li><p>Run Core locally (from core folder):</p><pre><code class="makeup sh" translate="no"><span class=""> $ BUNDLE=self mix phx.server
</span></code></pre></li><li><p>Go to browser</p><p> The Core app is running at: <a href="http://localhost:4000">http://localhost:4000</a></p></li></ol><h2 id="customizing" class="section-heading">
  <a href="#customizing" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Customizing</span>
</h2>
<h3 id="branding" class="section-heading">
  <a href="#branding" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Branding</span>
</h3>
<ul><li>Replace <a href="core/assets/static/images/icons/self.svg">self.svg</a> and <a href="core/assets/static/images/icons/self_wide.svg">self_wide.svg</a> with your icons of choice.</li><li>Change <a href="core/lib/core_web/ui/footer.ex">footer.ex</a> to format the platform footer or remove it completely</li></ul><h3 id="menu-items" class="section-heading">
  <a href="#menu-items" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Menu items</span>
</h3>
<ul><li>In <a href="core/bundles/self/lib/menu/items.ex">items.ex</a> you will find all the menu items. Add custom items when required.</li></ul><p>Core supports the following page layouts:</p><ul><li>Stripped: minimalistic page without menu</li><li>Website: menu at the top</li><li>Workspace: menu on the left</li></ul><p>Change the menus here:</p><ul><li><a href="core/bundles/self/lib/layouts/stripped/menu_builder.ex">Stripped</a></li><li><a href="core/bundles/self/lib/layouts/website/menu_builder.ex">Website</a></li><li><a href="core/bundles/self/lib/layouts/workspace/menu_builder.ex">Workspace</a></li></ul><h3 id="rate-limiters" class="section-heading">
  <a href="#rate-limiters" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Rate limiters</span>
</h3>
<p>To prevent users from exhausting resources on external services, Core uses rate limiters. The local configuration of rate limiters can be found in <code class="inline">core/config/dev.exs</code>:</p><pre><code class="Elixir">config :core, :rate,
  prune_interval: 5 * 1000,
  quotas: [
    [service: :azure_blob, limit: 1, unit: :call, window: :second, scope: :local],
    [service: :azure_blob, limit: 100, unit: :byte, window: :second, scope: :local]
  ]</code></pre><p>.. and the production configuration can be found in <code class="inline">core/config/config.exs</code>:</p><pre><code class="Elixir">config :core, :rate,
  prune_interval: 60 * 60 * 1000,
  quotas: [
    [service: :azure_blob, limit: 1000, unit: :call, window: :minute, scope: :local],
    [service: :azure_blob, limit: 10_000_000, unit: :byte, window: :day, scope: :local],
    [service: :azure_blob, limit: 1_000_000_000, unit: :byte, window: :day, scope: :global]
  ]</code></pre><h2 id="release-instructions" class="section-heading">
  <a href="#release-instructions" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Release instructions</span>
</h2>
<ol><li>Create a Docker image</li></ol><pre><code class="makeup sh" translate="no"><span class="gp unselectable">$ </span><span class="">cd core
</span><span class="gp unselectable">$ </span><span class="">docker build  --build-arg VERSION=1.0.0 --build-arg BUNDLE=self . -t self:latest
</span><span class="gp unselectable">$ </span><span class="">docker image save self -o self.zip
</span></code></pre><ol start="2"><li>Run the Docker image</li></ol><p>Required environment variables:</p><table><thead><tr><th style="text-align: left;">Variable</th><th style="text-align: left;">Description</th><th style="text-align: left;">Example value</th></tr></thead><tbody><tr><td style="text-align: left;">APP_NAME</td><td style="text-align: left;">Core app name</td><td style="text-align: left;">&quot;Self&quot;</td></tr><tr><td style="text-align: left;">APP_DOMAIN</td><td style="text-align: left;">domain where the Core app is hosted</td><td style="text-align: left;">&quot;my.server.com&quot;</td></tr><tr><td style="text-align: left;">APP_MAIL_DOMAIN</td><td style="text-align: left;">Domain of your email (after the @)</td><td style="text-align: left;">&quot;self.com&quot;</td></tr><tr><td style="text-align: left;">APP_ADMINS</td><td style="text-align: left;">String with space seperated email adresses of the system admins, supports wildcards</td><td style="text-align: left;">&quot;person1@self.com person2@self.com&quot;</td></tr><tr><td style="text-align: left;">DB_USER</td><td style="text-align: left;">Username</td><td style="text-align: left;">\&lt;my-username&gt;</td></tr><tr><td style="text-align: left;">DB_PASS</td><td style="text-align: left;">Password</td><td style="text-align: left;">\&lt;my-password&gt;</td></tr><tr><td style="text-align: left;">DB_HOST</td><td style="text-align: left;">Hostname</td><td style="text-align: left;">&quot;domain.where.database.lives&quot;</td></tr><tr><td style="text-align: left;">DB_NAME</td><td style="text-align: left;">Name of the database in the PostgreSQL</td><td style="text-align: left;">&quot;self_prod&quot;</td></tr><tr><td style="text-align: left;">SECRET_KEY_BASE</td><td style="text-align: left;">64-bit sequence of random characters</td><td style="text-align: left;">\&lt;long-sequence-of-characters&gt;</td></tr><tr><td style="text-align: left;">STATIC_PATH</td><td style="text-align: left;">Path to folder where uploaded files can be stored</td><td style="text-align: left;">&quot;/tmp&quot;</td></tr><tr><td style="text-align: left;">UNSPLASH_ACCESS_KEY</td><td style="text-align: left;">Application access key registered on <a href="https://unsplash.com/">Unsplash</a> (Image Catalog)</td><td style="text-align: left;">&quot;hcejpnHRuFWL-fKXLYqhGBt1Dz0_tTjeNifgD01VkGE&quot;</td></tr><tr><td style="text-align: left;">UNSPLASH_APP_NAME</td><td style="text-align: left;">Application name registered on <a href="https://unsplash.com/">Unsplash</a> (Image Catalog)</td><td style="text-align: left;">&quot;Self&quot;</td></tr><tr><td style="text-align: left;">STORAGE_SERVICES</td><td style="text-align: left;">Comma seperated list of storage services</td><td style="text-align: left;">&quot;yoda, aws, azure&quot;</td></tr></tbody></table><p>Optional environment variables:</p><table><thead><tr><th style="text-align: left;">Variable</th><th style="text-align: left;">Description</th><th style="text-align: left;">Example value</th></tr></thead><tbody><tr><td style="text-align: left;">LOG_LEVEL</td><td style="text-align: left;">Console log level</td><td style="text-align: left;">&quot;debug&quot;, &quot;info&quot;, &quot;warn&quot;, &quot;error&quot;</td></tr></tbody></table><p>| SENTRY_DSN | app monitoring | <a href="https://1234febac1234365cfe2d1fad616845b@o1234721120555008.ingest.sentry.io/1235721234883520%22">https://1234febac1234365cfe2d1fad616845b@o1234721120555008.ingest.sentry.io/1235721234883520&quot;</a>
| GOOGLE_SIGN_IN_CLIENT_ID | | &quot;123466465353-mui7en8912341rpn6qaevb89rd01234.apps.googleusercontent.com&quot; |
| GOOGLE_SIGN_IN_CLIENT_SECRET | | &quot;Q_lSWMy1234nPhxof1234Xyc&quot; |
| SURFCONEXT_SITE | SURFconext site | &quot;<a href="https://connect.test.surfconext.nl%22">https://connect.test.surfconext.nl&quot;</a> |
| SURFCONEXT_CLIENT_ID | SURFconext client ID | &quot;self.com&quot; |
| SURFCONEXT_CLIENT_SECRET | SURFconext client secret | &quot;12343HieOjb1234hcBpL&quot; |
| STORAGE_S3_PREFIX | Prefix for S3 builtin storage objects. Without this variable &quot;builtin&quot; storage service will default to local filesystem | &quot;storage&quot; |
| CONTENT_S3_PREFIX | Prefix for S3 content objects | &quot;content&quot; |
| FELDSPAR_S3_PREFIX | Prefix for S3 feldspar objects | &quot;feldspar&quot; |
| PUBLIC_S3_URL | Public accessable url of an S3 service | &quot;<a href="https://self-public.s3.eu-central-1.amazonaws.com%22">https://self-public.s3.eu-central-1.amazonaws.com&quot;</a> |
| PUBLIC_S3_BUCKET | Name of the bucket on the S3 service | &quot;self-prod&quot; |
| DIST_HOSTS | Comma seperated list of hosts in the cluster, see: <a href="https://elixirschool.com/en/lessons/advanced/otp_distribution">OTP Distribution</a> | &quot;one, two&quot; |</p>
</div>

<div class="bottom-actions" id="bottom-actions">
  <div class="bottom-actions-item">

      <a href="api-reference.html" class="bottom-actions-button" rel="prev">
        <span class="subheader">
          ← Previous Page
        </span>
        <span class="title">
API Reference
        </span>
      </a>

  </div>
  <div class="bottom-actions-item">

      <a href="readme.html" class="bottom-actions-button" rel="next">
        <span class="subheader">
          Next Page →
        </span>
        <span class="title">
Eyra Mono
        </span>
      </a>

  </div>
</div>
    <footer class="footer">
      <p>

        <span class="line">
          <button class="a-main footer-button display-quick-switch" title="Search HexDocs packages">
            Search HexDocs
          </button>

            <a href="core.epub" title="ePub version">
              Download ePub version
            </a>

        </span>
      </p>

      <p class="built-using">
        Built using
        <a href="https://github.com/elixir-lang/ex_doc" title="ExDoc" target="_blank" rel="help noopener" translate="no">ExDoc</a> (v0.36.1) for the

          <a href="https://elixir-lang.org" title="Elixir" target="_blank" translate="no">Elixir programming language</a>

      </p>

    </footer>
  </div>
</main>
</div>

  </body>
</html>
